<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>リバーシ</title>
    </head>
    <body>
        <canvas id="myCanvas" width="800" height="800" style="border:1px solid #000000; transform: scale(0.9);">
        </canvas>

        <script>
            var canvas = document.getElementById("myCanvas");
            var ctx = canvas.getContext("2d");
            ctx.fillStyle = "rgba(0, 122, 51, 0.7)";
            ctx.fillRect(0 , 0, 800, 800);
            ctx.font = "90px Arial";
            var player = 1
            var blocks = [[],[],[],[],[],[],[],[]]
            

            for (let i = 1; i < 8; i++) {   //ボードを分割
                ctx.moveTo(0  , i * 100);
                ctx.lineTo(800, i * 100);
                ctx.moveTo(i * 100, 0  );
                ctx.lineTo(i * 100, 800);
            }
            ctx.stroke();

            ctx.fillStyle = "black"
            ctx.beginPath();
            ctx.arc(450,350,40,0,2*Math.PI);
            ctx.arc(350,450,40,0,2*Math.PI);
            ctx.fill();
            ctx.fillStyle = "white"
            ctx.beginPath();
            ctx.arc(350,350,40,0,2*Math.PI);
            ctx.arc(450,450,40,0,2*Math.PI);
            ctx.fill();


            
            canvas.addEventListener('click', onClick, false);
            function onClick (e) {  //空のマスにクリックするとマークを描かれるイベント
                var x = y = 0;
                x = e.clientX - canvas.offsetLeft;
                y = e.clientY - canvas.offsetTop;

                var No ;
                
                if (player == 1) {
                    if (Draw("black") != 10) {
                        player = 2
                    }
                }
                else if (player == 2) {
                    if (Draw("white") != 10) {
                        No = -1
                        player = 1
                    }
                }
            
                function Draw(color) {    //石を描くの関数
                    var No;
                    if (color == "black") {
                        No = 1
                    }
                    else{
                        No = -1
                    }
                    var loop_break;
                    for (let x_axis = 0; x_axis < 8; x_axis++) { //ｘ軸
                        for (let y_axis = 0; y_axis < 8; y_axis++) { //ｙ軸

                            if (x <= 100*(y_axis+1) && y <= 100*(x_axis+1) ) {

                                if (blocks[x_axis][y_axis] !== undefined) { //複数のクリックを防止
                                    alert("無効なクリック")
                                    return 10
                                    break
                                }
                                ctx.fillStyle = color
                                ctx.beginPath();
                                ctx.arc(100 * (y_axis+1) -50 ,100*(x_axis+1) - 50,40,0,2*Math.PI);
                                ctx.fill();
                                loop_break = true
                                blocks[x_axis][y_axis] = No
                                break
                            }
                        }
                        if (loop_break == true) {
                            break
                        }
                    }
                }
            };


        </script>

    </body>
</html>